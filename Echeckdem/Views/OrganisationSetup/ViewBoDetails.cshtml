@model List<Ncmlocbo>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @TempData["ErrorMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<table class="org-details-body-table" id="bodetailsdata">
    <thead>
        <tr>
            <th>Location Code</th>
            <th>Project Code</th>
            <th>Client Name</th>
            <th>Project Address</th>
            <th>Nature of Work</th>
            <th>Project Cost</th>
            <th>Edit</th>
        </tr>
    </thead>
    <tbody id="boDetailsTable">
        @foreach (var bo in Model)
        {
            <tr>
                <td>@bo.Lcode</td>
                <td>@bo.ProjectCode</td>
                <td>@bo.ClientName</td>
                <td>@bo.ProjectAddress</td>
                <td>@bo.NatureofWork</td>
                <td>@bo.ProjectCostEst</td> 
               @*  <td>
                    <a href="@Url.Action("EditBoDetail", "OrganisationSetup",new { lcode = bo.Lcode })" class="btn btn-primary btn-sm">Edit</a>
                </td> *@
                <td>
                    <i class="fas fa-pen edit-icon" style="color: #dd3432; font-size: 14px; cursor: pointer;"></i>
                </td>
            </tr>
        }
    </tbody>
</table>

<script>
    $(document).ready(function () {
       var oid = "";
       // Populate the modal with data
       $('.edit-icon').on('click', function () {

           var row = $(this).closest('tr');
           oid = row.find('td[data-field="Oid"]').text().trim(); // Set the global OID value
    @* alert("Oid value: " + oid); *@


           var locationId = row.data('id'); // Assuming data-id attribute for location ID
           var Lcode = row.find('td[data-field="Lcode"]').text();
           var Lname = row.find('td[data-field="Lname"]').text();
           var Lcity = row.find('td[data-field="Lcity"]').text();
           var Lstate = row.find('td[data-field="Lstate"]').text();
           var Lregion = row.find('td[data-field="Lregion"]').text();
           var Iscentral = row.find('td[data-field="Iscentral"]').text().includes("Yes") ? 1 : 0;
           var Iscloc = row.find('td[data-field="Iscloc"]').text().includes("Yes") ? 1 : 0;
           var Lactive = row.find('td[data-field="Lactive"]').text().includes("Yes") ? 1 : 0;
    @*  var Ltype = row.find('td[data-field="Ltype"]').text().trim(); *@
           var LtypeDescription = row.find('td[data-field="Ltype"]').text().trim();
           var Lsetup = row.find('td[data-field="Lsetup"]').text().trim();

           var LtypeValue = "";
           if (LtypeDescription === "SE") {
               LtypeValue = "S";
           } else if (LtypeDescription === "Fact") {
               LtypeValue = "F";
           } else if (LtypeDescription === "BOCW") {
               LtypeValue = "BO"; // Default or no value
           }


           // Populate modal fields
           $('#locationId').val(locationId);
           $('#Lcode').val(Lcode);
           $('#Lname').val(Lname);
           $('#Lcity').val(Lcity);
           $('#Lstate').val(Lstate);
           $('#Lregion').val(Lregion);
           $('#Iscentral').val(Iscentral);
           $('#Iscloc').val(Iscloc);
           $('#Lactive').val(Lactive);
    @* $('#Ltype').val(Ltype); *@
           $('#Ltype').val(LtypeValue);
           $('#Lsetup').val(Lsetup);

           $('#editLocationModal').css('display', 'block');
           $('#locationDataTable').css('display', 'none');
       });

       $('.close-btn').on('click', function () {
           $('#editLocationModal').css('display', 'none');
           $('#locationDataTable').css('display', 'table');
       });
       });
    });
</script>



