

<form id="uploadForm" asp-action="Upload" method="post" enctype="multipart/form-data">
    <div class="form-group">
        <label for="file">Upload Excel File:</label>
        <input type="file" name="file" class="form-control" />
    </div>
    <button  type="submit" class="btn btn-primary">Upload</button>
</form>


<div id="messageContainer" class="alert mt-3" style="display:none;"></div>



<script>
    $(document).ready(function () {
        $("#uploadForm").submit(function (e) {
            e.preventDefault(); // Prevent normal form submission

            var formData = new FormData(this);

            // Log the form data for debugging
            for (var pair of formData.entries()) {
                console.log(pair[0] + ', ' + pair[1]);
            }

            $.ajax({
                url: '@Url.Action("Upload", "OrganisationSetup")', 
                type: 'POST',
                data: formData,
                contentType: false,
                processData: false,
                success: function (response) {
                    if (response.success) {
                        // Display success message
                        $('#messageContainer').removeClass('alert-danger').addClass('alert-success');
                        $('#messageContainer').text(response.message).fadeIn().delay(3000).fadeOut();
                    } else {
                        // Display error message
                        $('#messageContainer').removeClass('alert-success').addClass('alert-danger');
                        $('#messageContainer').text(response.message).fadeIn().delay(3000).fadeOut();
                    }
                },
                error: function () {
                    // Display general error message
                    $('#messageContainer').removeClass('alert-success').addClass('alert-danger');
                    $('#messageContainer').text('An error occurred. Please try again.').fadeIn().delay(3000).fadeOut();
                }
            });
        });
    });
</script>